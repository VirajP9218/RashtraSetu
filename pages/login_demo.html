<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RashtraSetu | Profile</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<style>
body{background:#0f1419;color:#fff;margin-left:230px;font-family:Segoe UI}
.sidebar{width:230px;height:100vh;background:#0A2647;position:fixed;left:0;top:0;padding-top:20px}
.sidebar h3{text-align:center;color:#FFDE59}
.menu-item{padding:12px 20px;color:#fff;text-decoration:none;display:flex;align-items:center}
.menu-item:hover{background:#144272}
.menu-item i{margin-right:10px}
.login-box,.profile-box{max-width:600px;margin:60px auto;background:#111;padding:25px;border-radius:14px}
.issue-card{background:#000;padding:15px;border-radius:10px;margin-bottom:10px;border:1px solid #333}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
  <h3>RashtraSetu</h3>
  <a href="home.html" class="menu-item"><i class="fa fa-house"></i>Home</a>
  <a href="profile.html" class="menu-item"><i class="fa fa-user"></i>Profile</a>
  <a href="#" onclick="logout()" class="menu-item"><i class="fa fa-right-from-bracket"></i>Logout</a>
</div>

<!-- LOGIN -->
<div class="login-box" id="loginBox">
<h4>Citizen Login</h4>
<input class="form-control mb-2" id="mobile" placeholder="Mobile Number">
<input class="form-control mb-3" id="pin" placeholder="PIN Code">
<button class="btn btn-primary w-100" onclick="login()">Login</button>
</div>

<!-- PROFILE -->
<div class="profile-box d-none" id="profileBox">
<h4>Welcome Citizen <span id="userId"></span></h4>
<p>PIN: <span id="userPin"></span></p>
<hr>
<h5>Your Issues</h5>
<div id="myIssues"></div>
</div>

<script>
function login(){
  const mobile=document.getElementById("mobile").value;
  const pin=document.getElementById("pin").value;
  if(mobile.length!==10||pin.length!==6){alert("Invalid details");return;}
  localStorage.setItem("rs_session",JSON.stringify({mobile,pin}));
  location.reload();
}

function logout(){
  localStorage.removeItem("rs_session");
  location.reload();
}

function loadProfile(){
  const session=JSON.parse(localStorage.getItem("rs_session"));
  if(!session)return;

  document.getElementById("loginBox").classList.add("d-none");
  document.getElementById("profileBox").classList.remove("d-none");

  const userKey=session.mobile+"_"+session.pin;
  document.getElementById("userId").innerText=session.mobile.slice(-4);
  document.getElementById("userPin").innerText=session.pin;

  const issues=JSON.parse(localStorage.getItem("issues_"+userKey))||[];
  const box=document.getElementById("myIssues");
  box.innerHTML=issues.length?"" : "<p class='text-muted'>No issues posted yet</p>";

  issues.forEach(i=>{
    box.innerHTML+=`<div class="issue-card">${i}</div>`;
  });
}

loadProfile();
</script>

</body>
</html>
